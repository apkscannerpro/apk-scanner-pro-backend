<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>

     <!-- Google Tag Manager -->
<script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MNHGZN7V');
</script>
<!-- End Google Tag Manager -->
  
  <meta name='impact-site-verification' value='48b7fe51-bb39-4a36-9ce5-ba9334c5b096'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  <title>APK Scanner Pro ‚Äì Free APK Malware Scanner | Online Android Virus Check</title>
  <!-- Canonical Tag -->
  <link rel="canonical" href="https://www.apkscannerpro.com/" />

  <!-- Meta SEO -->
  <meta name="description" content="APK Scanner Pro lets you scan APK files online for malware, trojans, spyware, and viruses. Get 200 free scans daily. AI-powered with VirusTotal & Bitdefender. Secure your Android apps before installing."/>
  <meta name="keywords" content="APK Scanner, free apk malware scanner, scan apk online, android virus check, apk virus scanner, scan play store apk, apk scanner pro, online apk scan, android security, AI malware detection"/>
  <meta name="robots" content="index, follow"/>

  <!-- Favicon -->
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon"/>
  <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon"/>
  <link rel="icon" href="{{ url_for('static', filename='logo.png') }}" sizes="32x32" type="image/png">
  <link rel="icon" href="{{ url_for('static', filename='logo.png') }}" sizes="192x192" type="image/png">

  <!-- Open Graph -->
  <meta property="og:title" content="APK Scanner Pro ‚Äì Free Online APK Malware Scanner"/>
  <meta property="og:description" content="Scan APK files instantly for malware. 200 free scans/day. Extra scans $1. AI-powered + VirusTotal + Bitdefender. Protect your Android apps before you install."/>
  <meta property="og:image" content="{{ url_for('static', filename='logo.png') }}"/>
  <meta property="og:url" content="https://apkscannerpro.com"/>
  <meta property="og:type" content="website"/>

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="APK Scanner Pro ‚Äì Free APK Malware Scanner"/>
  <meta name="twitter:description" content="Scan APK files for free with AI + VirusTotal + Bitdefender. Detect spyware, trojans & malware. 200 free scans/day."/>
  <meta name="twitter:image" content="{{ url_for('static', filename='logo.png') }}"/>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"/>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TRVNTQ0ZT4"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TRVNTQ0ZT4');
  </script>

  <!-- Structured Data for Organization / Logo -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "APK Scanner Pro",
    "url": "https://www.apkscannerpro.com",
    "logo": "https://www.apkscannerpro.com/static/logo.png",
    "sameAs": [
      "https://www.tiktok.com/@apkscanner",
      "https://www.instagram.com/apkscannerpro/"
    ]
  }
  </script>

  <style>
    body { font-family:'Poppins',sans-serif; margin:0; background:#0a0a0a; color:#fff; }
    header { background:linear-gradient(90deg,#00c6ff,#0072ff); padding:2rem 1rem; text-align:center; }
    header img { max-height:90px; margin-bottom:0.5rem; }
    header h1 { font-size:2.6rem; margin:0.5rem 0; font-weight:700; }
    header p { font-size:1.2rem; max-width:850px; margin:0 auto; }
    .btn { background:#ff4757; color:#fff; padding:1rem 2rem; border:none; font-size:1.1rem; border-radius:8px; cursor:pointer; margin-top:1rem; font-weight:600; transition:0.3s; }
    .btn:hover { background:#ff6b81; }
    .container { max-width:950px; margin:2rem auto; padding:0 1rem; text-align:center; }
    section { margin-bottom:3rem; }
    h2 { color:#00c6ff; font-size:2rem; margin-bottom:1rem; }
    ul { list-style:none; padding:0; }
    ul li { margin:0.5rem 0; font-size:1.1rem; }
    .input { padding:0.8rem; margin:0.5rem 0; border-radius:6px; border:none; font-size:1rem; width:260px; max-width:85%; }
    #quota { margin:1rem 0; font-weight:600; font-size:1.1rem; }
    #report { display:none; }
    .success-box { display:none; background:#0f5132; color:#d1e7dd; border:1px solid #0f5132; padding:1rem; border-radius:6px; margin-top:1rem; text-align:center; }
    .error-box { display:none; background:#842029; color:#f8d7da; border:1px solid #842029; padding:1rem; border-radius:6px; margin-top:1rem; text-align:center; }
    .adsense,.affiliate { border:2px dashed #444; padding:1.5rem; margin:2rem auto; border-radius:10px; color:#aaa; }
    footer { background:#111; padding:2rem 1rem; text-align:center; color:#ccc; font-size:0.9rem; }
    footer a { color:#00c6ff; margin:0 0.5rem; }
    .faq { text-align:left; background:#111; padding:1.5rem; border-radius:10px; margin:2rem auto; }
    .faq h3 { color:#00c6ff; margin:0.8rem 0; }
    #paymentPopup { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.92); justify-content:center; align-items:center; z-index:999; }
    .popup-content { background:#1a1a1a; padding:2rem; border-radius:10px; text-align:center; max-width:400px; }

    /* Spinner styles */
    #loadingSpinner {
      display: none;
      margin: 20px auto;
      border: 6px solid #f3f3f3;
      border-top: 6px solid #4CAF50;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>

<!-- Payment Popup -->
<div id="paymentPopup" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.92); justify-content:center; align-items:center; z-index:999;">
  <div class="popup-content" style="background:#1a1a1a; padding:2rem; border-radius:10px; text-align:center; max-width:420px;">
    <h2>üí≥ Upgrade to Paid Scan</h2>
    <p>You‚Äôve used all <strong>200 free scans today</strong>. Additional scans cost <strong>$1 each</strong>.</p>
    
    <p style="margin-top:15px; font-size:0.9rem; line-height:1.6; color:#ccc;">
      Please make payment to:<br><br>
      <strong>Bank:</strong> Citibank<br>
      <strong>Account No:</strong> 70588660001898904<br>
      <strong>Beneficiary:</strong> Sehan Shahid
    </p>

    <p style="margin-top:10px; font-size:0.85rem; line-height:1.5; color:#ccc;">
      üåç <strong>For International Transfers:</strong><br>
      SWIFT Code: <strong>CITIUS33</strong>
    </p>

    <p style="margin-top:10px; font-size:0.85rem; line-height:1.5; color:#ccc;">
      üá∫üá∏ <strong>For USA Transfers:</strong><br>
      Routing (ABA): <strong>031100209</strong>
    </p>
    
    <p style="margin-top:12px; font-size:0.85rem; color:#bbb;">
      After transfer, enter your email & payment reference below to continue.
    </p>
    
    <input type="email" id="paidEmail" class="input" placeholder="Your email"><br>
    <input type="text" id="paymentRef" class="input" placeholder="Payment reference / screenshot ID"><br>
    <button class="btn" onclick="completePayment()">‚úÖ Done, Continue</button>
  </div>
</div>

  
<!-- Google Tag Manager (noscript) -->
<noscript>
  <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MNHGZN7V"
  height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->

  
  <!-- HERO -->
<header>
  <img src="{{ url_for('static', filename='logo.png') }}" alt="APK Scanner Pro Logo" style="max-width: 280px; height: auto; display: block; margin: 0 auto;">
  <h1>APK Scanner Pro</h1>
  <p>Free & AI-powered <strong>APK malware scanner</strong> for Android. Instantly detect spyware, trojans, adware, and viruses inside APK files. Powered by <strong>AI + VirusTotal + Bitdefender</strong> to give you maximum protection before installation.</p>
  <button class="btn" onclick="document.getElementById('uploadSection').scrollIntoView({behavior:'smooth'})">üöÄ Start Free Scan</button>
</header>

<div class="container">
  <!-- FEATURES -->
  <section>
    <h2>‚úÖ Why Choose APK Scanner Pro?</h2>
    <ul>
      <li>‚ö° <strong>Instant APK malware scan</strong> results in seconds</li>
      <li>üéÅ <strong>200 free APK scans daily</strong> per device/IP</li>
      <li>üìß Detailed <strong>malware report delivered via email</strong></li>
      <li>üõ°Ô∏è Privacy-first: No file storage, in-memory scanning only</li>
      <li>üí≥ After limit ‚Üí <strong>$1/scan via Bank Transfer</strong></li>
    </ul>
  </section>

  <!-- ABOUT & TRUST (E-E-A-T SECTION) -->
  <section class="about-trust" style="padding: 40px 20px; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 12px; margin: 30px 0;">
    <div style="max-width: 900px; margin: auto; text-align: center;">
      <h2 style="font-size: 1.8rem; margin-bottom: 15px;">üîí About APK Scanner Pro</h2>
      <p style="font-size: 1rem; color: #374151; line-height: 1.6; margin-bottom: 20px;">
        APK Scanner Pro is built to protect <strong>Android users worldwide</strong> with <strong>AI-driven security</strong>.  
        Our mission is to provide a free, reliable, and automated malware detection system for APK files and Play Store apps.
      </p>

      <h3 style="font-size: 1.3rem; margin-bottom: 10px; color:#111827;">üì© Contact Us</h3>
      <p style="font-size: 1rem; color: #111827; margin-bottom: 20px;">
        Email: <a href="mailto:support@apkscannerpro.com" style="color: #2563eb; font-weight: bold;">support@apkscannerpro.com</a>
      </p>

      <h3 style="font-size: 1.3rem; margin-bottom: 10px; color:#111827;">üìö Trusted Sources</h3>
      <p style="font-size: 1rem; color: #111827; line-height: 1.6; margin-bottom: 20px;">
        Our reports and recommendations are backed by research from trusted cybersecurity leaders:  
        <a href="https://www.google.com/intl/en/safety/" target="_blank" style="color: #2563eb;">Google Safety Center</a>,  
        <a href="https://www.bitdefender.com/" target="_blank" style="color: #2563eb;">Bitdefender</a>,  
        <a href="https://us.norton.com/" target="_blank" style="color: #2563eb;">Norton Security</a>.
      </p>

      <p style="font-size: 0.9rem; color: #6b7280; margin-top: 20px;">
        ‚úÖ Reports generated by <strong>APK Scanner Pro</strong><br/>
        ü§ñ Reviewed by <em>AI Security Assistant</em> for accuracy & clarity
      </p>
    </div>
  </section>

<!-- SCAN UPLOAD -->
<section id="uploadSection">
  <h2>üîç Scan Your APK Online</h2>

  <!-- Live Free Quota -->
  <p id="quota" style="font-weight:bold; color:#00c6ff;">Loading scan quota...</p>

  <!-- Upload Form -->
  <form id="scanForm">
    <input type="file" id="apkInput" name="apk" accept=".apk" class="input"><br>
    <p style="margin:0.8rem 0;">or paste APK / Play Store link:</p>
    <input type="url" id="apkLink" name="apk_link" class="input" placeholder="https://...apk OR Play Store link"><br>
    <input type="email" id="emailInput" name="email" placeholder="Your email (report sent here)" required class="input"><br>
    <button class="btn" type="submit">Upload / Submit Link & Scan</button>
  </form>

  <!-- Free vs Premium Scan Info -->
  <div style="margin: 30px 0; padding:20px; border:1px solid #0072ff; border-radius:10px; background:#0a0a0a; color:#fff;">
    <h3 style="margin-bottom:12px; color:#00c6ff;">üöÄ Free vs Premium Scan</h3>

    <!-- Feature Table -->
    <table style="width:100%; text-align:left; border-collapse: collapse; color:#fff;">
      <tr>
        <th style="border-bottom:1px solid #00c6ff; padding:8px;">Features</th>
        <th style="border-bottom:1px solid #00c6ff; padding:8px;">Free</th>
        <th style="border-bottom:1px solid #00c6ff; padding:8px;">Premium</th>
      </tr>
      <tr>
        <td style="padding:8px; border-bottom:1px solid #444;">Basic Malware Scan</td>
        <td style="padding:8px; border-bottom:1px solid #444;">‚úîÔ∏è</td>
        <td style="padding:8px; border-bottom:1px solid #444;">‚úîÔ∏è</td>
      </tr>
      <tr>
        <td style="padding:8px; border-bottom:1px solid #444;">Historical Malware Lookup</td>
        <td style="padding:8px; border-bottom:1px solid #444;">‚ùå</td>
        <td style="padding:8px; border-bottom:1px solid #444;">‚úîÔ∏è</td>
      </tr>
      <tr>
        <td style="padding:8px; border-bottom:1px solid #444;">Advanced Analysis Report</td>
        <td style="padding:8px; border-bottom:1px solid #444;">‚ùå</td>
        <td style="padding:8px; border-bottom:1px solid #444;">‚úîÔ∏è</td>
      </tr>
    </table>

    <!-- Free Quota Live Display -->
    <div id="freeQuota" style="font-weight: bold; margin-top:15px; color:#00c6ff;">
      üéâ You have <span id="freeQuotaValue">200</span> free scans remaining today
    </div>

    <!-- Premium Info -->
    <div id="premiumInfo" style="margin-top:20px; padding:15px; border:1px solid #ff4757; border-radius:10px; background:#1a1a1a; color:#fff;">
      <h3 style="margin-bottom:10px; color:#ff6b81;">üíé Premium Detailed Report</h3>
      <p style="margin-bottom:8px; font-size:1rem;">
        Get a <strong>deep analysis report</strong> with historical malware lookup, and advanced insights so it can be download safely.
      </p>
      <p style="margin-bottom:8px; font-size:1.1rem;">
        <strong>Price:</strong> $15 per premium scan
      </p>

      <!-- Premium Quota -->
      <p id="premiumQuota" style="margin-top:5px; font-size:0.95rem; color:#ccc;">
        Loading premium scans remaining today...
      </p>

      <!-- Premium Option -->
      <label style="display:block; margin-top:8px; color:#ccc; font-size:0.95rem; cursor:pointer;">
        <input type="checkbox" id="premiumOption" style="margin-right:6px;"> I want the Premium Scan (manual payment)
      </label>

      <button id="premiumPayBtn" style="margin-top:10px; padding:6px 12px; background:#ff6b81; color:white; border:none; border-radius:5px; cursor:pointer;">
        Pay & Unlock
      </button>
    </div>
  </div>

    </form>

    <!-- Spinner -->
    <div id="loadingSpinner"></div>

    <div id="successBox" class="success-box"></div>
    <div id="errorBox" class="error-box"></div>
  </section>

  <!-- Support Us Button -->
<div style="text-align:center; margin:40px 0;">
  <button onclick="document.getElementById('supportPopup').style.display='flex'" 
          style="background:#2563eb; color:#fff; border:none; border-radius:10px; padding:12px 20px; font-size:16px; cursor:pointer;">
    üí≥ Support APK Scanner Pro
  </button>
</div>

<!-- Support Popup -->
<div id="supportPopup" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.92); justify-content:center; align-items:center; z-index:999;">
  <div class="popup-content" style="background:#1a1a1a; padding:2rem; border-radius:10px; text-align:center; max-width:420px;">
    <h2>üí≥ Bank Details</h2>
    <p style="margin-top:15px; font-size:0.9rem; line-height:1.6; color:#ccc;">
      <strong>Bank:</strong> Citibank<br>
      <strong>SWIFT:</strong> CITIUS33<br>
      <strong>Account No:</strong> 70588660001898904<br>
      <strong>Beneficiary:</strong> Sehan Shahid
    </p>
    <p style="margin-top:12px; font-size:0.85rem; color:#bbb;">
      üåç Accepting payments worldwide.<br>
      After transfer, kindly email proof to <strong>support@apkscannerpro.com</strong>.
    </p>
    <button onclick="document.getElementById('supportPopup').style.display='none'" 
            style="background:#ff4757; color:#fff; border:none; border-radius:10px; padding:10px 18px; font-size:15px; cursor:pointer; margin-top:15px;">
      ‚úñ Close
    </button>
  </div>
</div>


  <!-- Blog Internal Link -->
  <div style="text-align:center; margin-top:15px;">
    <a href="/best-antivirus-for-android" 
       style="color:#0073e6; text-decoration:none; font-weight:bold;">
       üìñ Read our Blog: Best Antivirus for Android in 2025
    </a>
  </div>


    <!-- SECURITY NOTE -->
<div style="margin-top: 30px; padding: 20px; border-radius: 12px; background: #f9f9f9; border: 1px solid #ddd; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.05); color:#222;">
  <h3 style="font-size:20px; font-weight:bold; margin-bottom:10px;">üîí Protect Your Device. Protect Your Data.</h3>
  <p style="font-size:16px; color:#444; max-width:700px; margin:0 auto;">
    Thousands of Android users unknowingly install malicious APKs that steal personal data, track activity, and cause financial loss. 
    Don‚Äôt be the next victim ‚Äî use <strong>APK Scanner Pro</strong> to scan every APK before installation.
  </p>
</div>

<!-- FAQ (SEO JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How many free scans do I get daily?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "You get 200 free APK scans per device/IP every 24 hours."
      }
    },
    {
      "@type": "Question",
      "name": "How do I pay after free scans?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Once you reach 200 free scans per day, additional scans cost $1 each. Payment is made via bank transfer (Citibank). After transfer, just enter your email & reference ID in the popup to unlock more scans."
      }
    },
    {
      "@type": "Question",
      "name": "Can I scan Play Store links instead of files?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, paste any Google Play link or APK download URL and APK Scanner Pro will fetch and scan it automatically."
      }
    },
    {
      "@type": "Question",
      "name": "Is APK Scanner Pro safe?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. APK Scanner Pro uses trusted engines (VirusTotal + Bitdefender) combined with AI. All files are scanned in-memory and never stored."
      }
    }
  ]
}
</script>


    <!-- NEWSLETTER -->
    <section>
      <h2>üì© Stay Updated</h2>
      <p>Get APK malware alerts, Android security news & exclusive tips.</p>
      <form id="newsletterForm">
        <input type="text" name="name" placeholder="Your Name" class="input" required>
        <input type="email" name="email" placeholder="Your Email" class="input" required>
        <button class="btn" type="submit">Subscribe</button>
      </form>
    </section>

    <!-- AdSense -->
    <section class="adsense">
      [ Google AdSense Placeholder ]
    </section>

    <!-- Affiliate -->
    <section class="affiliate">
      [ Norton / Bitdefender Affiliate Placeholder ]
    </section>

    <!-- FAQ VISIBLE -->
<section class="faq" style="margin:40px auto; max-width:800px; padding:20px; background:#f9f9f9; border:1px solid #ddd; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.05);">
  <h2 style="font-size:24px; font-weight:bold; margin-bottom:20px; text-align:center;">‚ùì Frequently Asked Questions</h2>

  <h3 style="font-size:18px; font-weight:600; margin-top:15px;">How many free scans do I get daily?</h3>
  <p style="color:#444; margin-bottom:10px;">You get <strong>200 free APK scans</strong> per device/IP every 24 hours.</p>

  <h3 style="font-size:18px; font-weight:600; margin-top:15px;">üí≥ How do I pay after free scans?</h3>
  <p style="color:#444; margin-bottom:10px;">Once you reach 200 free scans per day, additional scans cost <strong>$1 each</strong>. Payment is made via bank transfer (Citibank). After transfer, just enter your email & reference ID in the popup to unlock more scans.</p>

  <h3 style="font-size:18px; font-weight:600; margin-top:15px;">Can I scan Play Store links instead of files?</h3>
  <p style="color:#444; margin-bottom:10px;">Yes! Paste any Google Play link or APK download URL ‚Äî we‚Äôll fetch and scan it for you.</p>

  <h3 style="font-size:18px; font-weight:600; margin-top:15px;">Is APK Scanner Pro safe?</h3>
  <p style="color:#444; margin-bottom:10px;">Absolutely. We use trusted engines (<strong>VirusTotal + Bitdefender</strong>) combined with AI. Files are scanned in-memory and never stored.</p>
</section>

  </div>

  <!-- FOOTER -->
  <footer>
    <div style="margin-bottom: 1rem; text-align: center;">
  <!-- Social Links -->
  <a href="https://www.tiktok.com/@apkscanner" target="_blank" style="margin: 0 8px;">
    <img 
      src="https://cdn-icons-png.flaticon.com/512/3046/3046120.png" 
      alt="TikTok" 
      style="width:22px; height:22px;">
  </a>
  
  <a href="https://www.instagram.com/apkscannerpro/" target="_blank" style="margin: 0 8px;">
    <img 
      src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png" 
      alt="Instagram" 
      style="width:22px; height:22px;">
  </a>

  <!-- Support Email -->
  <div style="margin-top: 10px;">
    <a href="mailto:support@apkscannerpro.com" style="text-decoration: none; color: #FFFFFF; font-size: 14px;">
      <img 
        src="https://cdn-icons-png.flaticon.com/512/561/561127.png" 
        alt="Email" 
        style="width:18px; height:18px; vertical-align: middle; margin-right: 6px;">
      support@apkscannerpro.com
    </a>
  </div>
</div>

    <p>&copy; 2025 APK Scanner Pro ‚Ä¢ 
      <a href="/pricing">Pricing</a> | 
      <a href="/best-antivirus-for-android">Blog</a> | 
      <a href="/privacy">Privacy</a> | 
      <a href="/terms">Terms</a> | 
      <a href="/refund-policy">Refund Policy</a> | 
      <a href="/thank-you">Thank You</a>
    </p>
  </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
  let scanAttempted = false;

  async function updateQuota() {
    try {
      const res = await fetch('/scan-stats');
      if (!res.ok) throw new Error("Network response was not ok");
      const data = await res.json();

      console.log("Quota data from backend:", data); // debug

      // Main quota placeholder (top of section)
      const quotaEl = document.getElementById('quota');
      if (quotaEl && typeof data.free_scans_remaining !== "undefined" && typeof data.free_limit !== "undefined") {
        if (data.free_scans_remaining > 0) {
          quotaEl.textContent = `üéâ ${data.free_scans_remaining} of ${data.free_limit} free scans left today`;
        } else {
          quotaEl.textContent = "‚ö†Ô∏è No free scans left. Please pay $1 per scan.";
        }
      }

      // Free quota (inside info box)
      const freeQuotaEl = document.getElementById('freeQuota');
      if (freeQuotaEl && typeof data.free_scans_remaining !== "undefined" && typeof data.free_limit !== "undefined") {
        if (data.free_scans_remaining > 0) {
          freeQuotaEl.textContent = `üéâ ${data.free_scans_remaining} of ${data.free_limit} free scans left today`;
        } else {
          freeQuotaEl.textContent = "‚ö†Ô∏è No free scans left. Please pay $1 per scan.";
        }
      }

      // Premium quota
      const premiumQuotaEl = document.getElementById('premiumQuota');
      const premiumInfoEl = document.getElementById('premiumInfo');
      if (premiumQuotaEl && premiumInfoEl) {
        premiumInfoEl.style.display = 'block'; // always show
        if (typeof data.premium_scans_remaining !== "undefined" && typeof data.premium_limit !== "undefined") {
          premiumQuotaEl.textContent = `üéØ ${data.premium_scans_remaining} of ${data.premium_limit} premium scans left`;
        } else {
          premiumQuotaEl.textContent = "üéØ Premium detailed scans available for $15 each";
        }
      }
    } catch (err) {
      console.error("Quota fetch error:", err);

      const quotaEl = document.getElementById('quota');
      if (quotaEl) quotaEl.textContent = "‚ö†Ô∏è Unable to load scan quota";

      const freeQuotaEl = document.getElementById('freeQuota');
      const premiumQuotaEl = document.getElementById('premiumQuota');
      if (freeQuotaEl) freeQuotaEl.textContent = "‚ö†Ô∏è Unable to load free scans";
      if (premiumQuotaEl) premiumQuotaEl.textContent = "‚ö†Ô∏è Unable to load premium scans";

      const premiumInfoEl = document.getElementById('premiumInfo');
      if (premiumInfoEl) premiumInfoEl.style.display = 'block';
    }
  }

  function onUserScanAttempt() {
    scanAttempted = true;
    updateQuota(); // refresh immediately after scan
  }

  // Attach listener to form submit
  const scanForm = document.getElementById('scanForm');
  if (scanForm) {
    scanForm.addEventListener('submit', () => {
      onUserScanAttempt();
    });
  }

  // Run once after page load
  updateQuota();

  // Optional: refresh every 60s
  setInterval(updateQuota, 60000);
});


  // -----------------------------
  // Poll scan result
  // -----------------------------
  async function pollResult(jobId, btn, email) {
    try {
      const res = await fetch(`/scan-result/${jobId}`);
      const json = await res.json();

      if (json.status === "pending") {
        setTimeout(() => pollResult(jobId, btn, email), 3000);
      } else if (json.status === "done" && json.success) {
        document.getElementById('loadingSpinner').style.display = "none";
        const successBox = document.getElementById('successBox');
        successBox.style.display = "block";
        successBox.innerHTML = `‚úÖ Your report has been sent to <strong>${email}</strong>.`;

        // Update quota AFTER scan success
        await updateQuota();

        btn.disabled = false;
        btn.textContent = 'Upload / Submit Link & Scan';
      } else {
        document.getElementById('loadingSpinner').style.display = "none";
        const errorBox = document.getElementById('errorBox');
        errorBox.style.display = "block";
        errorBox.textContent = json.error || "Scan failed.";
        btn.disabled = false;
        btn.textContent = 'Upload / Submit Link & Scan';
      }
    } catch {
      document.getElementById('loadingSpinner').style.display = "none";
      const errorBox = document.getElementById('errorBox');
      errorBox.style.display = "block";
      errorBox.textContent = "Error fetching scan results.";
      btn.disabled = false;
      btn.textContent = 'Upload / Submit Link & Scan';
    }
  }

  // -----------------------------
  // Scan form submission
  // -----------------------------
  const scanForm = document.getElementById('scanForm');
  if (scanForm) {
    scanForm.addEventListener('submit', async e => {
      e.preventDefault();
      onUserScanAttempt();

      const fd = new FormData(e.target);
      const premiumCheckbox = document.getElementById('premiumOption');
      if (premiumCheckbox && premiumCheckbox.checked) fd.append('premium', 'true');

      const btn = e.target.querySelector('button');
      btn.disabled = true;
      btn.textContent = 'Uploading...';
      document.getElementById('successBox').style.display = "none";
      document.getElementById('errorBox').style.display = "none";
      document.getElementById('loadingSpinner').style.display = "block";

      try {
        const res = await fetch('/scan-async', { method: 'POST', body: fd });
        const json = await res.json();

        if (json.error && json.payment_required) {
          // Free or premium limit reached ‚Üí show payment popup
          document.getElementById('loadingSpinner').style.display = "none";
          showPaymentPopup();
          btn.disabled = false;
          btn.textContent = 'Upload / Submit Link & Scan';
          return;
        }

        if (json.job_id) {
          const email = fd.get("email");
          pollResult(json.job_id, btn, email);
          if (premiumCheckbox) premiumCheckbox.checked = false; // reset
        } else {
          document.getElementById('loadingSpinner').style.display = "none";
          const errorBox = document.getElementById('errorBox');
          errorBox.style.display = "block";
          errorBox.textContent = json.error || 'Scan failed';
          btn.disabled = false;
          btn.textContent = 'Upload / Submit Link & Scan';
        }
      } catch (err) {
        console.error(err);
        document.getElementById('loadingSpinner').style.display = "none";
        const errorBox = document.getElementById('errorBox');
        errorBox.style.display = "block";
        errorBox.textContent = 'Upload failed';
        btn.disabled = false;
        btn.textContent = 'Upload / Submit Link & Scan';
      }
    });
  }

  // -----------------------------
  // Initial quota load & refresh every 10 sec
  // -----------------------------
  updateQuota();
  setInterval(updateQuota, 10000);

  // Expose scan attempt function globally
  window.onUserScanAttempt = onUserScanAttempt;
});

  // -----------------------------
  // Newsletter Form Submit
  // -----------------------------
  document.getElementById('newsletterForm').addEventListener('submit', async e => {
    e.preventDefault();
    const fd = new FormData(e.target);
    try {
      const res = await fetch('/subscribe', { method: 'POST', body: fd });
      const json = await res.json();
      if (json.ok) {
        alert('üéâ Subscribed successfully!');
        e.target.reset();
      } else {
        alert(json.error || 'Subscribe failed');
      }
    } catch {
      alert('‚ö†Ô∏è Network error. Please try again.');
    }
  });

  // -----------------------------
// Payment popup functions
// -----------------------------
function showPaymentPopup() {
  document.getElementById('paymentPopup').style.display = 'flex';
}
function completePayment() {
  window.location.href = "https://www.apkscannerpro.com/thank-you";
}

// -----------------------------
// Auto trigger payment when premium checkbox clicked
// -----------------------------
const premiumOption = document.getElementById('premiumOption');
if (premiumOption) {
  premiumOption.addEventListener('change', function () {
    if (this.checked) showPaymentPopup();
  });
}

// Premium Pay Button
const premiumPayBtn = document.getElementById('premiumPayBtn');
if (premiumPayBtn) {
  premiumPayBtn.addEventListener('click', () => showPaymentPopup());
}
</script>
</body>
</html>























